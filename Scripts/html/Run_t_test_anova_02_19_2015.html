
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Run_t_test_anova_02_19_2015</title><meta name="generator" content="MATLAB 8.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-03-01"><meta name="DC.source" content="Run_t_test_anova_02_19_2015.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">RUN T-TEST on %Change in LFP at 5 Different Bands</a></li><li><a href="#2">++++++++++++++++++++++ACE++++++++++++++++++++++++++++++++++++++++++++</a></li><li><a href="#3">++++++++++++++++++++++++++  BIC ++++++++++++++++++++++++++++++++++++++</a></li><li><a href="#4">+++++++++++++++++++++++CAR 5 uM +++++++++++++++++++++++++++++++++++++++</a></li><li><a href="#5">++++++++++++++++++++++++++++++++++++++++++++++++++CAR 15 uM +++++++++++++++</a></li><li><a href="#6">+++++++++++++++++++++++++++++++++++++++++++++++++CAR 30 +++++++++++++++</a></li><li><a href="#7">+++++++++++++DOMOIC ACID+++++++++++++++++++++++++++++++++++++++++++++++++</a></li><li><a href="#8">++++++++++++++++++++++++++++++++++++++++++++++++++++++DMSO+++++++++++++++</a></li><li><a href="#9">+++++++++++++GLY+++++++++++++++++++++++++++++++++++++++++++++++++++++++++</a></li><li><a href="#10">+++++++++++++++++++++++++++H20+++++++++++++++++++++++++++++++++++++++++</a></li><li><a href="#11">+++++++++++++LINDANE+++++++++++++++++++++++++++++++++++++++++++++++++</a></li><li><a href="#12">++++++++++++++++++++++++++++++PER25++++++++++++++++++++++++++++++++++++++</a></li><li><a href="#13">+++++++++++++++++++++PERM 50uM+++++++++++++++++++++++++++++++++++++++</a></li><li><a href="#14">+++++++++++++++++++++++++++++++++TRI+++++++++++++++++++++++++++++++++++++</a></li><li><a href="#15">Save results</a></li><li><a href="#16">T-test vs. baseline: Write Results</a></li><li><a href="#17">+++++++ OUTPUT T-Test vs Control ++++++++++++++++++++++++++++++++++++++</a></li></ul></div><h2>RUN T-TEST on %Change in LFP at 5 Different Bands<a name="1"></a></h2><p>t-test_anova.m Diana Hall 01/27/2014 code to do anova</p><pre class="codeinput"><span class="comment">% add directory</span>
mac=1;
<span class="keyword">if</span> ~mac
    addpath(genpath(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\Scripts'</span> ) )
<span class="keyword">else</span>
    addpath(genpath(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/Scripts'</span> ) )
<span class="keyword">end</span>;
</pre><h2>++++++++++++++++++++++ACE++++++++++++++++++++++++++++++++++++++++++++<a name="2"></a></h2><p>load data</p><pre class="codeinput"><span class="keyword">if</span> ~mac
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_ace.mat'</span>);
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_conace.mat'</span>);
<span class="keyword">else</span>
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_ace.mat'</span>);
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_conace.mat'</span>);
<span class="keyword">end</span>;

<span class="comment">% make analysis data set</span>
filepath.ace=ace.filepath;
filepath.conace=con.filepath;
chem=ace;
cont=con; cont.file = con.file;
nFiles=length(cont.file) ;
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

ACEanova = make_t_anova_data(chem, cont, nFiles, want) ;
<span class="comment">% run analysis</span>
ACE = do_t_anova(ACEanova, want ) ;
clear(<span class="string">'ace'</span>);clear(<span class="string">'con'</span>);
</pre><pre class="codeoutput">
anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]

</pre><h2>++++++++++++++++++++++++++  BIC ++++++++++++++++++++++++++++++++++++++<a name="3"></a></h2><p>load data</p><pre class="codeinput"><span class="keyword">if</span> ~mac
  load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_27_2014_bic.mat'</span>);
  load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\10_30_2014_biccon.mat'</span>);
<span class="keyword">else</span>
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_27_2014_bic.mat'</span>);
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/10_30_2014_biccon.mat'</span>);
<span class="keyword">end</span>;


<span class="comment">%  t-test or anova</span>
chem=bic;
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ;
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

filepath.bic=bic.filepath;
filepath.conbic=con.filepath ;

BICanova = make_t_anova_data_AEOnly(chem, cont, nFiles, want) ;

BIC = do_t_anova(BICanova, want ) ;
clear(<span class="string">'bic'</span>); clear(<span class="string">'con'</span>);
</pre><pre class="codeoutput">
anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]

</pre><h2>+++++++++++++++++++++++CAR 5 uM +++++++++++++++++++++++++++++++++++++++<a name="4"></a></h2><p>load data</p><pre class="codeinput"><span class="keyword">if</span> ~mac
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_car5.mat'</span>);
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_car5con.mat'</span>);
<span class="keyword">else</span>
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_car5.mat'</span>);
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_car5con.mat'</span>);
<span class="keyword">end</span>;

<span class="comment">% make analysis data set</span>
chem=car;
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ;
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;
<span class="comment">% get filepaths for writing</span>
filepath.car5 = car.filepath;
filepath.concar5=con.filepath ;

CAR5anova = make_t_anova_data(chem, cont, nFiles, want) ;
<span class="comment">% run analysis</span>
CAR5 = do_t_anova(CAR5anova, want ) ;
<span class="comment">%results: fail to reject at all bands</span>
clear(<span class="string">'con'</span>); clear(<span class="string">'car'</span>);
</pre><pre class="codeoutput">
anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]

</pre><h2>++++++++++++++++++++++++++++++++++++++++++++++++++CAR 15 uM +++++++++++++++<a name="5"></a></h2><p>load data</p><pre class="codeinput"><span class="keyword">if</span> ~mac
    load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_car15.mat'</span>);
    load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_car15con.mat'</span>);
<span class="keyword">else</span>
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_car15.mat'</span>);
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_car15con.mat'</span>);
<span class="keyword">end</span>;

<span class="comment">% make analysis data set</span>
chem=car;
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ;
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;
<span class="comment">% get filepaths for writing</span>
filepath.car15 = car.filepath;
filepath.concar15=con.filepath ;
echo <span class="string">off</span>;
CAR15anova = make_t_anova_data(chem, cont, nFiles, want) ;
<span class="comment">% run analysis</span>
echo <span class="string">off</span>;
CAR15 = do_t_anova(CAR15anova, want ) ;
<span class="comment">%results: fail to reject at all bands</span>
<span class="keyword">for</span> i=1:5
disp( strcat( <span class="string">' band'</span>, num2str(i) ) )
disp(  CAR15{i}.t )
<span class="keyword">end</span>;
clear(<span class="string">'con'</span>); clear(<span class="string">'car'</span>);
</pre><pre class="codeoutput">
anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]

 band1
     0

 band2
     1

 band3
     0

 band4
     0

 band5
     0

</pre><h2>+++++++++++++++++++++++++++++++++++++++++++++++++CAR 30 +++++++++++++++<a name="6"></a></h2><p>load data</p><pre class="codeinput"><span class="keyword">if</span> ~mac
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_car30.mat'</span>);
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_car30con.mat'</span>);
<span class="keyword">else</span>
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_car30.mat'</span>);
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_car30con.mat'</span>);
<span class="keyword">end</span>;

<span class="comment">% make analysis data set</span>
chem=car;
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ;
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;
<span class="comment">% get filepaths for writing</span>
filepath.car30 = car.filepath;
filepath.concar30=con.filepath ;

CAR30anova = make_t_anova_data(chem, cont, nFiles, want) ;
<span class="comment">% run analysis</span>
CAR30 = do_t_anova(CAR30anova, want ) ;
<span class="comment">%results: fail to reject at all bands</span>
clear(<span class="string">'car'</span>); clear(<span class="string">'con'</span>);
</pre><pre class="codeoutput">
anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]

</pre><h2>+++++++++++++DOMOIC ACID+++++++++++++++++++++++++++++++++++++++++++++++++<a name="7"></a></h2><p>load data</p><pre class="codeinput"><span class="keyword">if</span> ~mac
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\10_30_2014_da.mat'</span>);
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\10_30_2014_conDA.mat'</span>);
<span class="keyword">else</span>
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/10_30_2014_da.mat'</span>);
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/10_30_2014_conDA.mat'</span>);
<span class="keyword">end</span>;

<span class="comment">% make analysis data set</span>
filepath.da=da.filepath;
filepath.conda=con.filepath;
chem=da;
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ;
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

DAanova = make_t_anova_data(chem, cont, nFiles, want) ;
<span class="comment">% run analysis</span>
DA = do_t_anova(DAanova, want ) ;
<span class="comment">% DA{1}</span>
clear(<span class="string">'da'</span>);clear(<span class="string">'con'</span>);
</pre><pre class="codeoutput">
anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]

</pre><h2>++++++++++++++++++++++++++++++++++++++++++++++++++++++DMSO+++++++++++++++<a name="8"></a></h2><p>load data</p><pre class="codeinput"><span class="keyword">if</span> ~mac
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\12_30_2014_dmso.mat'</span>);
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\12_30_2014_condmso.mat'</span>);
<span class="keyword">else</span>
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/12_30_2014_dmso.mat'</span>);
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/12_30_2014_condmso.mat'</span>);
<span class="keyword">end</span>;

<span class="comment">% make analysis data set</span>
filepath.dmso=dmso.filepath;
filepath.condmso=con.filepath;
chem=dmso;
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ;
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

DMSOanova = make_t_anova_data(chem, cont, nFiles, want) ;
<span class="comment">% run analysis</span>
DMSO = do_t_anova(DMSOanova, want ) ;
clear(<span class="string">'dmso'</span>);clear(<span class="string">'con'</span>);
</pre><pre class="codeoutput">
anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]

</pre><h2>+++++++++++++GLY+++++++++++++++++++++++++++++++++++++++++++++++++++++++++<a name="9"></a></h2><p>load data</p><pre class="codeinput"><span class="keyword">if</span> ~mac
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_gly.mat'</span>);
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_congly.mat'</span>);
<span class="keyword">else</span>
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_gly.mat'</span>);
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_congly.mat'</span>);
<span class="keyword">end</span>;

<span class="comment">% make analysis data set</span>
filepath.gly=gly.filepath;
filepath.congly=con.filepath;
chem=gly;
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ;
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

GLYanova = make_t_anova_data(chem, cont, nFiles, want) ;
<span class="comment">% run analysis</span>
GLY = do_t_anova(GLYanova, want ) ;
clear(<span class="string">'gly'</span>);clear(<span class="string">'con'</span>);
</pre><pre class="codeoutput">
anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]

</pre><h2>+++++++++++++++++++++++++++H20+++++++++++++++++++++++++++++++++++++++++<a name="10"></a></h2><p>load data</p><pre class="codeinput"><span class="keyword">if</span> ~mac
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_h20.mat'</span>);
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_conh20.mat'</span>);
<span class="keyword">else</span>
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_h20.mat'</span>);
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_conh20.mat'</span>);
<span class="keyword">end</span>;

<span class="comment">% make analysis data set</span>
filepath.h20=h20.filepath;
filepath.conh20=con.filepath;
chem=h20;
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ;
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

H20anova = make_t_anova_data(chem, cont, nFiles, want) ;
<span class="comment">% run analysis</span>
H20 = do_t_anova(H20anova, want ) ;
clear(<span class="string">'h20'</span>);clear(<span class="string">'con'</span>);
</pre><pre class="codeoutput">
anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]

</pre><h2>+++++++++++++LINDANE+++++++++++++++++++++++++++++++++++++++++++++++++<a name="11"></a></h2><p>load data</p><pre class="codeinput"><span class="keyword">if</span> ~mac
    load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\02_15_2016_lindane.mat'</span>);
    load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\02_15_2016_conlin.mat'</span>);
<span class="keyword">else</span>
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/02_15_2016_lindane.mat'</span>);
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/02_15_2016_conlin.mat'</span>);
<span class="keyword">end</span>;

<span class="comment">% make analysis data set</span>
filepath.lin=lin.filepath;
filepath.conlin=con.filepath;
chem=lin;
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ;
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

LINanova = make_t_anova_data(chem, cont, nFiles, want) ;
<span class="comment">% run analysis</span>
LIN = do_t_anova(LINanova, want ) ; <span class="comment">% LIN{1}</span>
clear(<span class="string">'lin'</span>);clear(<span class="string">'con'</span>);
</pre><pre class="codeoutput">
anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]

</pre><h2>++++++++++++++++++++++++++++++PER25++++++++++++++++++++++++++++++++++++++<a name="12"></a></h2><p>load data</p><pre class="codeinput"><span class="keyword">if</span> ~mac
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\02_11_2014_per25.mat'</span>);
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\10_30_2014_per25con.mat'</span>);
<span class="keyword">else</span>
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/02_11_2014_per25.mat'</span>);
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/10_30_2014_per25con.mat'</span>);
<span class="keyword">end</span>;

<span class="comment">% make analysis data set</span>
chem=per;
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ;
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

filepath.per25=per.filepath;
filepath.conper25=con.filepath ;

PER25anova = make_t_anova_data(chem, cont, nFiles, want) ;
<span class="comment">% run analysis</span>
PER25 = do_t_anova(PER25anova, want ) ;
<span class="comment">%results: fail to reject at bands = 1,2,3,4; sig. diff at band 5</span>
clear(<span class="string">'per'</span>);clear(<span class="string">'con'</span>);
</pre><pre class="codeoutput">
anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]

</pre><h2>+++++++++++++++++++++PERM 50uM+++++++++++++++++++++++++++++++++++++++<a name="13"></a></h2><p>load data</p><pre class="codeinput"><span class="keyword">if</span> ~mac
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_per50.mat'</span>);
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_conPER50.mat'</span>);
<span class="keyword">else</span>
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_per50.mat'</span>);
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_conPER50.mat'</span>);
<span class="keyword">end</span>;

<span class="comment">% make analysis data set</span>
filepath.per50=per.filepath;
filepath.per50con=con.filepath;
chem=per;   <span class="comment">%which files in con are PER baseline</span>
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ;
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

PER50anova = make_t_anova_data(chem, cont, nFiles, want) ;
<span class="comment">% run analysis</span>
PER50 = do_t_anova(PER50anova, want ) ;
<span class="comment">%results: fail to reject at bands = 1,2,3,4; sig. diff at band 5</span>
clear(<span class="string">'per'</span>);clear(<span class="string">'con'</span>);
</pre><pre class="codeoutput">
anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]

</pre><h2>+++++++++++++++++++++++++++++++++TRI+++++++++++++++++++++++++++++++++++++<a name="14"></a></h2><p>load data</p><pre class="codeinput"><span class="keyword">if</span> ~mac
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\8_9_2014_tri.mat'</span>);
 load(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\8_9_2014_contri.mat'</span>);
<span class="keyword">else</span>
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/8_9_2014_tri.mat'</span>);
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/8_9_2014_contri.mat'</span>);
<span class="keyword">end</span>;

<span class="comment">% make analysis data set</span>
filepath.tri=tri.filepath;
filepath.conh20=con.filepath;
chem=tri;
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ;
want.sec=0; want.ch=0; want.well=0;want.diff=0;want.pchange=1;

TRIanova = make_t_anova_data(chem, cont, nFiles, want) ;
<span class="comment">% run analysis</span>
TRI = do_t_anova(TRIanova, want ) ;
clear(<span class="string">'tri'</span>);clear(<span class="string">'con'</span>);
</pre><pre class="codeoutput">
anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]


anova = 

  Columns 1 through 4

    [1x1 struct]    [1x1 struct]    [1x1 struct]    [1x1 struct]

  Column 5

    [1x1 struct]

</pre><h2>Save results<a name="15"></a></h2><pre class="codeinput"> <span class="keyword">if</span> ~mac
    filename=<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_03_2015_pChangeanova.mat'</span> ;
 <span class="keyword">else</span>
     filename=<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/03_01_2016_pChangeanova.mat'</span> ;
 <span class="keyword">end</span>;
 save(filename, <span class="string">'BIC'</span>,<span class="string">'BICanova'</span>,<span class="string">'ACE'</span>, <span class="string">'ACEanova'</span>, <span class="keyword">...</span>
     <span class="string">'CAR5'</span>,<span class="string">'CAR5anova'</span>,<span class="string">'CAR15'</span>,<span class="string">'CAR15anova'</span>,<span class="string">'CAR30'</span>,<span class="string">'CAR30anova'</span>,<span class="keyword">...</span>
     <span class="string">'DA'</span>,<span class="string">'DAanova'</span>,<span class="string">'DMSO'</span>,<span class="string">'DMSOanova'</span>,<span class="string">'LIN'</span>, <span class="string">'LINanova'</span>,<span class="keyword">...</span>
     <span class="string">'GLY'</span>, <span class="string">'GLYanova'</span>,<span class="string">'H20'</span>,<span class="string">'H20anova'</span>,<span class="keyword">...</span>
     <span class="string">'PER25'</span>, <span class="string">'PER25anova'</span>, <span class="string">'PER50'</span>, <span class="string">'PER50anova'</span>,<span class="string">'TRI'</span>,<span class="string">'TRIanova'</span>, <span class="keyword">...</span>
     <span class="string">'filepath'</span>) ;
</pre><h2>T-test vs. baseline: Write Results<a name="16"></a></h2><p>++++++++++++++++++++++++++++++++++++++ write results with t-test H_0: t=1, H_a: t~=1</p><pre class="codeinput">mac=1;
<span class="keyword">if</span> ~mac
    addpath(genpath(<span class="string">'F:\EXTRAP\matlab_Cina_Herr_Diana\Scripts'</span> ) )
<span class="keyword">else</span>
    addpath(genpath(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/Scripts'</span> ) )
<span class="keyword">end</span>;

wantData=1;
<span class="keyword">if</span> wantData
    load(<span class="string">'/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/03_01_2016_pChangeanova.mat'</span>);
<span class="keyword">end</span>;



    xlsfilestr=<span class="string">'/Volumes/BACKUP/EXTRAP/documents/Results/lfp_results_t-testdiff1_03_01_2016.csv'</span>;
    title1={<span class="string">'Results: % Baseline chem vs. % baseline control, mean all Electrodes, t-test: eq. var'</span>};
    title=title{1};
    <span class="comment">%da,gly,ace,tri are H20 controls</span>
    <span class="comment">%bic, car, per30, per50 are dmso controls</span>
    chemName= {<span class="string">'ace'</span>,<span class="string">'bic'</span>, <span class="string">'da'</span>,<span class="string">'dmso'</span>,<span class="string">'car5'</span>,<span class="string">'car15'</span>, <span class="string">'car30'</span>,<span class="string">'gly'</span>, <span class="string">'h20'</span>,<span class="keyword">...</span>
        <span class="string">'lin'</span>,<span class="string">'per25'</span>,<span class="string">'per50'</span>,<span class="string">'tri'</span> };

    fileID = fopen(xlsfilestr,<span class="string">'w'</span>);
    fprintf( fileID,<span class="string">'%s\n'</span>,  title );
    startCell=3;
    <span class="keyword">for</span> k=1:size(chemName,2)
    <span class="comment">% write files</span>

        <span class="keyword">if</span> strcmp( chemName{1,k},<span class="string">'per25'</span> )
            anovaData = PER25anova ; test = PER25;
            <span class="keyword">for</span> i=1:length(filepath.per25)
                <span class="keyword">if</span> mac
                    temp=strsplit(filepath.per25{1}, <span class="string">'\'</span>);
                    n1=temp{end};
                <span class="keyword">else</span>
                    [p,n1,x] = fileparts( filepath.per25{i} );
                <span class="keyword">end</span>;
                n{i}=n1 ;
            <span class="keyword">end</span>;
            <span class="comment">% 2 sample t-test to control</span>
            <span class="keyword">for</span> curB=1:5
                [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
                anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
                ttest2(PER25anova{curB}.pchange, DMSOanova{curB}.pchange ) <span class="comment">%significant</span>
            <span class="keyword">end</span>;
            nlines=length(filepath.per25);

        <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'per50'</span>)
            anovaData = PER50anova ; test = PER50
            <span class="keyword">for</span> i=1:length(filepath.per50)
                <span class="keyword">if</span> mac
                    temp=strsplit( filepath.per50{i}, <span class="string">'\'</span>);
                    n1=temp{end};
                <span class="keyword">else</span>
                    [p,n1,x] = fileparts( filepath.per50{i} );
                <span class="keyword">end</span>;

                n{i}=n1 ;
            <span class="keyword">end</span>;
            <span class="keyword">for</span> curB=1:5
                [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
                anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
                ttest2(PER50anova{curB}.pchange, DMSOanova{curB}.pchange ) <span class="comment">%significant</span>
            <span class="keyword">end</span>;
            nlines=length(filepath.per50);


        <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'car5'</span>)
            anovaData = CAR5anova ; test = CAR5
            <span class="keyword">for</span> i=1:length(filepath.car5)
                 <span class="keyword">if</span> mac
                    temp=strsplit(  filepath.car5{i}, <span class="string">'\'</span>);
                    n1=temp{end};
                <span class="keyword">else</span>
                     [p,n1,x] = fileparts( filepath.car5{i} );
                <span class="keyword">end</span>;

                n{i}=n1 ;
            <span class="keyword">end</span>;
            <span class="keyword">for</span> curB=1:5
                [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
                anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
                ttest2(anovaData{curB}.pchange, DMSOanova{curB}.pchange ) <span class="comment">%significant</span>
            <span class="keyword">end</span>;
            nlines=length(filepath.car5);

        <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'car15'</span>)
            anovaData = CAR15anova ; test = CAR15 ;
            <span class="keyword">for</span> i=1:length(filepath.car15 )
                <span class="keyword">if</span> mac
                    temp=strsplit(  filepath.car15{i}, <span class="string">'\'</span>);
                    n1=temp{end};
                <span class="keyword">else</span>
                     [p,n1,x] = fileparts( filepath.car15{i} );
                <span class="keyword">end</span>;

                n{i}=n1 ;
            <span class="keyword">end</span>;
            <span class="keyword">for</span> curB=1:5
                [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
                anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
                ttest2(anovaData{curB}.pchange, DMSOanova{curB}.pchange ) <span class="comment">%significant</span>
            <span class="keyword">end</span>;
            nlines=length(filepath.car15);

        <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'car30'</span>)
            anovaData = CAR30anova ; test = CAR30 ;
            <span class="keyword">for</span> i=1:length(filepath.car30)
                <span class="keyword">if</span> mac
                    temp=strsplit( filepath.car30{i} , <span class="string">'\'</span>);
                    n1=temp{end};
                <span class="keyword">else</span>
                     [p,n1,x] = fileparts( filepath.car30{i} );
                <span class="keyword">end</span>;

                n{i}=n1 ;
            <span class="keyword">end</span>;
            <span class="keyword">for</span> curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
                anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
                ttest2(anovaData{curB}.pchange, DMSOanova{curB}.pchange ) <span class="comment">%significant</span>
            <span class="keyword">end</span>;
            nlines=length(filepath.car30);

        <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'bic'</span> )
            anovaData = BICanova ; test = BIC;
            <span class="keyword">for</span> i=1:length(filepath.bic)
                 <span class="keyword">if</span> mac
                    temp=strsplit( filepath.bic{i}  , <span class="string">'\'</span>);
                    n1=temp{end};
                <span class="keyword">else</span>
                     [p,n1,x] = fileparts( filepath.bic{i} );
                <span class="keyword">end</span>;

                n{i}=n1 ;
            <span class="keyword">end</span>;
            <span class="keyword">for</span> curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
                anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
                ttest2(BICanova{curB}.pchange, DMSOanova{curB}.pchange ) <span class="comment">%significant</span>
            <span class="keyword">end</span>;
            nlines=length(filepath.bic);

        <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'da'</span>)
            anovaData = DAanova ; test = DA
            <span class="keyword">for</span> i=1:length(filepath.da)
                 <span class="keyword">if</span> mac
                    temp=strsplit(filepath.da{i} , <span class="string">'\'</span>);
                    n1=temp{end};
                <span class="keyword">else</span>
                     [p,n1,x] = fileparts( filepath.da{i} );
                <span class="keyword">end</span>;

                n{i}=n1 ;
            <span class="keyword">end</span>;
            <span class="keyword">for</span> curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
                anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
                ttest2(DAanova{curB}.pchange, H20anova{curB}.pchange ) <span class="comment">%significant</span>
            <span class="keyword">end</span>;
            nlines=length(filepath.da);


        <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'ace'</span>)
            anovaData = ACEanova ; test = ACE
            <span class="keyword">for</span> i=1:length(filepath.ace )
                <span class="keyword">if</span> mac
                    temp=strsplit( filepath.ace{i} , <span class="string">'\'</span>);
                    n1=temp{end};
                <span class="keyword">else</span>
                    [p,n1,x] = fileparts( filepath.ace{i} );
                <span class="keyword">end</span>;

                n{i}=n1 ;
            <span class="keyword">end</span>;
            <span class="keyword">for</span> curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
                anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
                ttest2(ACEanova{curB}.pchange, H20anova{curB}.pchange ) <span class="comment">%significant</span>
            <span class="keyword">end</span>;
            nlines=length(filepath.ace);

        <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'h20'</span>)
            anovaData = H20anova ; test = H20
            <span class="keyword">for</span> i=1:length(filepath.h20)
                <span class="keyword">if</span> mac
                    temp=strsplit(filepath.h20{i} , <span class="string">'\'</span>);
                    n1=temp{end};
                <span class="keyword">else</span>
                   [p,n1,x] = fileparts( filepath.h20{i} );
                <span class="keyword">end</span>;

                n{i}=n1 ;
            <span class="keyword">end</span>;
            nlines=length(filepath.h20);

        <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'dmso'</span>)
            anovaData = DMSOanova ; test = DMSO
            <span class="keyword">for</span> i=1:length(filepath.dmso)

                <span class="keyword">if</span> mac
                    temp=strsplit(filepath.dmso{i}, <span class="string">'\'</span>);
                    n1=temp{end};
                <span class="keyword">else</span>
                   [p,n1,x] = fileparts( filepath.dmso{i} );
                <span class="keyword">end</span>;

                n{i}=n1 ;
            <span class="keyword">end</span>;
            nlines=length(filepath.dmso);


        <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'tri'</span>)
            anovaData = TRIanova ; test = TRI;
            <span class="keyword">for</span> i=1:length(filepath.tri)
                 <span class="keyword">if</span> mac
                    temp=strsplit( filepath.tri{i} , <span class="string">'\'</span>);
                    n1=temp{end};
                <span class="keyword">else</span>
                  [p,n1,x] = fileparts( filepath.tri{i} );
                <span class="keyword">end</span>;

                n{i}=n1 ;
            <span class="keyword">end</span>;
            <span class="keyword">for</span> curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
                anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
                ttest2(TRIanova{curB}.pchange, H20anova{curB}.pchange ) <span class="comment">%significant</span>
            <span class="keyword">end</span>;
            nlines=length(filepath.tri );

        <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'gly'</span>)
            anovaData = GLYanova ; test = GLY ;
            <span class="keyword">for</span> i=1:length(filepath.gly)
                <span class="keyword">if</span> mac
                    temp=strsplit(  filepath.gly{i} , <span class="string">'\'</span>);
                   n1=temp{end};
                <span class="keyword">else</span>
                  [p,n1,x] = fileparts( filepath.gly{i} );
                <span class="keyword">end</span>;

                n{i}=n1 ;
            <span class="keyword">end</span>;
            <span class="keyword">for</span> curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
                anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
                ttest2(GLYanova{curB}.pchange, H20anova{curB}.pchange ) <span class="comment">%significant</span>
            <span class="keyword">end</span>;
            nlines=length(filepath.gly );
        <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'lin'</span>)
            anovaData = LINanova ; test = LIN ;
            <span class="keyword">for</span> i=1:length(filepath.lin)

                  [p,n1,x] = fileparts( filepath.lin{i} );


                n{i}=n1 ;
            <span class="keyword">end</span>;
            <span class="keyword">for</span> curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
                anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
                ttest2(LINanova{curB}.pchange, DMSOanova{curB}.pchange ) <span class="comment">%significant</span>
            <span class="keyword">end</span>;
            nlines=length(filepath.lin );

        <span class="keyword">end</span>;

        ex{1,1}=<span class="string">' '</span>; ex{2,1}=<span class="string">'1-4Hz'</span>; ex{3,1}=<span class="string">'4-8Hz'</span>; ex{4,1}=<span class="string">'8-14Hz'</span>;
        ex{5,1}=<span class="string">'14-30Hz'</span>; ex{6,1}=<span class="string">'30-50Hz'</span>;
        nFiles = length(anovaData{1}.pchange ) ;
        <span class="keyword">for</span> curfile=1:nFiles
            ex{1,1+curfile}=n{curfile} ;

        <span class="keyword">end</span>;

        <span class="keyword">for</span> j=1:5
            <span class="keyword">for</span> i=1:length(anovaData{1}.pchange)
                ex{1+j,i+1} = anovaData{j}.pchange(i);
            <span class="keyword">end</span>;
        <span class="keyword">end</span>;
        ex{1,2+nFiles}=<span class="string">'mean'</span>;
        ex{1,3+nFiles}=<span class="string">'se'</span>;
        ex{1,4+nFiles}=<span class="string">'sd'</span>;
        ex{1,5+nFiles}=<span class="string">'t-test diff from 1'</span>;
        ex{1,6+nFiles}=<span class="string">'p-value'</span>;
        ex{1,7+nFiles}=<span class="string">'lci'</span>;
        ex{1,8+nFiles}=<span class="string">'uci'</span>;
        ex{1,9+nFiles}=<span class="string">'n'</span>;
        <span class="keyword">for</span> j=1:5
            ex{1+j,2+nFiles}= mean(anovaData{j}.pchange);
            ex{1+j,3+nFiles}= test{j}.stats.sd/length(anovaData{j}.pchange);
            ex{1+j,4+nFiles}= test{j}.stats.sd;
            ex{1+j,5+nFiles}= test{j}.stats.tstat;
            ex{1+j,6+nFiles}= test{j}.tp_value;
            ex{1+j,7+nFiles}= test{j}.ci(1);
            ex{1+j,8+nFiles}= test{j}.ci(2);
            ex{1+j,9+nFiles}= test{j}.stats.df+1;
        <span class="keyword">end</span>;

        [nrows,ncols] = size(ex);
        <span class="comment">% fileID = fopen(xlsfilestr,'w');</span>
        fprintf(fileID, strcat( chemName{1,k}, <span class="string">'\n'</span>)  );
        <span class="keyword">for</span> row = 1:nrows
            <span class="keyword">if</span> row==1
                formatSpec = strcat( repmat(<span class="string">'%s ,'</span>, 1,(size(ex,2)-1)) , <span class="string">' %s\n'</span>);
                fprintf(fileID,formatSpec, ex{row,:});

            <span class="keyword">else</span>
                formatSpec = strcat(<span class="string">'%s ,'</span>,repmat(<span class="string">'%d ,'</span>,1,(size(ex,2)-2)), <span class="string">' %d\n'</span>  );
                fprintf(fileID,formatSpec,ex{row,:});
            <span class="keyword">end</span>;
        <span class="keyword">end</span>;

        clear(<span class="string">'ex'</span>);

        <span class="comment">%set startCell to empty lines</span>
        startCell=startCell+10 ;
    <span class="keyword">end</span>; <span class="comment">% end of for loop</span>

    <span class="comment">% close the file</span>
    fclose(fileID);
</pre><pre class="codeoutput error">Cell contents reference from a non-cell array object.

Error in Run_t_test_anova_02_19_2015 (line 412)
    title=title{1};
</pre><h2>+++++++ OUTPUT T-Test vs Control ++++++++++++++++++++++++++++++++++++++<a name="17"></a></h2><p>write results with t-test H_0: t=1, H_a: t~=1</p><pre class="codeinput"><span class="keyword">if</span> ~mac
    xlsfilestr=<span class="string">'F:\EXTRAP\documents\Results\lfp_results_t-testwControl_01_06_2015.csv'</span>;
<span class="keyword">else</span>
    xlsfilestr=<span class="string">'/Volumes/BACKUP/EXTRAP/documents/Results/lfp_results_t-testvControl_03_01_2016.csv'</span>;
<span class="keyword">end</span>;
title1={<span class="string">'Results: % Baseline chem vs. % baseline control, mean all Electrodes, t-test uneq. var'</span>};
title=title1{1};
fileID = fopen(xlsfilestr,<span class="string">'w'</span>);
fprintf( fileID,<span class="string">'%s\n'</span>,  title );

<span class="comment">%da,gly,ace,tri are H20 controls</span>
<span class="comment">%bic, car, per30, per50 are dmso controls</span>
chemName= {<span class="string">'ace'</span>,<span class="string">'bic'</span>, <span class="string">'da'</span>,<span class="string">'dmso'</span>,<span class="string">'car5'</span>,<span class="string">'car15'</span>, <span class="string">'car30'</span>,<span class="string">'gly'</span>, <span class="string">'h20'</span>,<span class="keyword">...</span>
    <span class="string">'lin'</span>,<span class="string">'per25'</span>,<span class="string">'per50'</span>,<span class="string">'tri'</span> };


startCell=3;
<span class="keyword">for</span> k=1:size(chemName,2)
<span class="comment">% write files</span>

    <span class="keyword">if</span> strcmp( chemName{1,k},<span class="string">'per25'</span> )
        anovaData = PER25anova ; test = PER25;
        <span class="keyword">for</span> i=1:length(filepath.per25)
            <span class="keyword">if</span> mac
                 temp=strsplit( filepath.per25{i} , <span class="string">'\'</span>);
                   n1=temp{end};
                <span class="keyword">else</span>
                   [p,n1,x] = fileparts( filepath.per25{i} );
                <span class="keyword">end</span>;

            n{i}=n1 ;
        <span class="keyword">end</span>;
        <span class="comment">% 2 sample t-test to control</span>
        <span class="keyword">for</span> curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
            anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
            ttest2(PER25anova{curB}.pchange, DMSOanova{curB}.pchange,<span class="string">'vartype'</span>,<span class="string">'unequal'</span> ) <span class="comment">%significant</span>
        <span class="keyword">end</span>;
        CONanova=DMSOanova;
        nlines=length(filepath.per25);

    <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'per50'</span>)
        anovaData = PER50anova ; test = PER50
        <span class="keyword">for</span> i=1:length(filepath.per50)
             <span class="keyword">if</span> mac
                 temp=strsplit( filepath.per50{i} , <span class="string">'\'</span>);
                   n1=temp{end};
                <span class="keyword">else</span>
                   [p,n1,x] = fileparts( filepath.per50{i} );
                <span class="keyword">end</span>;

            n{i}=n1 ;
        <span class="keyword">end</span>;
        <span class="keyword">for</span> curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
            anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
            ttest2(PER50anova{curB}.pchange, DMSOanova{curB}.pchange,<span class="string">'vartype'</span>,<span class="string">'unequal'</span> ) <span class="comment">%significant</span>
        <span class="keyword">end</span>;
        CONanova=DMSOanova;
        nlines=length(filepath.per50);


    <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'car5'</span>)
        anovaData = CAR5anova ; test = CAR5
        <span class="keyword">for</span> i=1:length(filepath.car5)
            <span class="keyword">if</span> mac
                 temp=strsplit(  filepath.car5{i}  , <span class="string">'\'</span>);
                   n1=temp{end};
                <span class="keyword">else</span>
                    [p,n1,x] = fileparts( filepath.car5{i} );
                <span class="keyword">end</span>;

            n{i}=n1 ;
        <span class="keyword">end</span>;
        <span class="keyword">for</span> curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
            anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
            ttest2(anovaData{curB}.pchange, DMSOanova{curB}.pchange,<span class="string">'vartype'</span>,<span class="string">'unequal'</span> ) <span class="comment">%significant</span>
        <span class="keyword">end</span>;
        CONanova=DMSOanova;
        nlines=length(filepath.car5);

    <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'car15'</span>)
        anovaData = CAR15anova ; test = CAR15 ;
        <span class="keyword">for</span> i=1:length(filepath.car15 )
            <span class="keyword">if</span> mac
                 temp=strsplit(  filepath.car15{i}  , <span class="string">'\'</span>);
                   n1=temp{end};
                <span class="keyword">else</span>
                     [p,n1,x] = fileparts( filepath.car15{i} );
                <span class="keyword">end</span>;

            n{i}=n1 ;
        <span class="keyword">end</span>;
        <span class="keyword">for</span> curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
            anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
            ttest2(anovaData{curB}.pchange, DMSOanova{curB}.pchange,<span class="string">'vartype'</span>,<span class="string">'unequal'</span> ) <span class="comment">%significant</span>
        <span class="keyword">end</span>;
        CONanova=DMSOanova;
        nlines=length(filepath.car15);

    <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'car30'</span>)
        anovaData = CAR30anova ; test = CAR30 ;
        <span class="keyword">for</span> i=1:length(filepath.car30)
            <span class="keyword">if</span> mac
                 temp=strsplit(  filepath.car30{i}  , <span class="string">'\'</span>);
                   n1=temp{end};
                <span class="keyword">else</span>
                    [p,n1,x] = fileparts( filepath.car30{i} );
                <span class="keyword">end</span>;

            n{i}=n1 ;
        <span class="keyword">end</span>;
        <span class="keyword">for</span> curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
            anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
            ttest2(anovaData{curB}.pchange, DMSOanova{curB}.pchange,<span class="string">'vartype'</span>,<span class="string">'unequal'</span> ) <span class="comment">%significant</span>
        <span class="keyword">end</span>;
        CONanova=DMSOanova;
        nlines=length(filepath.car30);

    <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'bic'</span> )
        anovaData = BICanova ; test = BIC;
        <span class="keyword">for</span> i=1:length(filepath.bic)
            <span class="keyword">if</span> mac
                 temp=strsplit(filepath.bic{i}  , <span class="string">'\'</span>);
                   n1=temp{end};
                <span class="keyword">else</span>
                    [p,n1,x] = fileparts( filepath.bic{i} );
                <span class="keyword">end</span>;

            n{i}=n1 ;
        <span class="keyword">end</span>;
        <span class="keyword">for</span> curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
            anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
            ttest2(BICanova{curB}.pchange, DMSOanova{curB}.pchange,<span class="string">'vartype'</span>,<span class="string">'unequal'</span> ) <span class="comment">%significant</span>
        <span class="keyword">end</span>;
        CONanova=DMSOanova;
        nlines=length(filepath.bic);

    <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'da'</span>)
        anovaData = DAanova ; test = DA
        <span class="keyword">for</span> i=1:length(filepath.da)
              <span class="keyword">if</span> mac
                 temp=strsplit(filepath.da{i}  , <span class="string">'\'</span>);
                   n1=temp{end};
                <span class="keyword">else</span>
                    [p,n1,x] = fileparts( filepath.da{i} );
                <span class="keyword">end</span>;

            n{i}=n1 ;
        <span class="keyword">end</span>;
        <span class="keyword">for</span> curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
            anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
            ttest2(DAanova{curB}.pchange, H20anova{curB}.pchange,<span class="string">'vartype'</span>,<span class="string">'unequal'</span> ) <span class="comment">%significant</span>
        <span class="keyword">end</span>;
        CONanova=H20anova;
        nlines=length(filepath.da);


    <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'ace'</span>)
        anovaData = ACEanova ; test = ACE
        <span class="keyword">for</span> i=1:length(filepath.ace )
            <span class="keyword">if</span> mac

                    temp=strsplit( filepath.ace{i}   , <span class="string">'\'</span>);
                    n1=temp{end};
                <span class="keyword">else</span>
                   [p,n1,x] = fileparts( filepath.ace{i} );
                <span class="keyword">end</span>;

            n{i}=n1 ;
        <span class="keyword">end</span>;
        <span class="keyword">for</span> curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
            anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
            ttest2(ACEanova{curB}.pchange, H20anova{curB}.pchange,<span class="string">'vartype'</span>,<span class="string">'unequal'</span> ) <span class="comment">%significant</span>
        <span class="keyword">end</span>;
        CONanova=H20anova;
        nlines=length(filepath.ace);

    <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'h20'</span>)
        anovaData = H20anova ; test = H20
        <span class="keyword">for</span> i=1:length(filepath.h20)
            <span class="keyword">if</span> mac
                    temp=strsplit( filepath.h20{i}   , <span class="string">'\'</span>);
                    n1=temp{end};
                <span class="keyword">else</span>
                   [p,n1,x] = fileparts( filepath.h20{i} );
                <span class="keyword">end</span>;

            n{i}=n1 ;
        <span class="keyword">end</span>;
        <span class="keyword">for</span> curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
            anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
            ttest2(H20anova{curB}.pchange, DMSOanova{curB}.pchange,<span class="string">'vartype'</span>,<span class="string">'unequal'</span> ) <span class="comment">%significant</span>
        <span class="keyword">end</span>;
        CONanova=DMSOanova;
        nlines=length(filepath.h20);

    <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'dmso'</span>)
        anovaData = DMSOanova ; test = DMSO
        <span class="keyword">for</span> i=1:length(filepath.dmso)
            <span class="keyword">if</span> mac
                    temp=strsplit( filepath.dmso{i}   , <span class="string">'\'</span>);
                    n1=temp{end};
                <span class="keyword">else</span>
                   [p,n1,x] = fileparts( filepath.dmso{i} );
                <span class="keyword">end</span>;

            n{i}=n1 ;
        <span class="keyword">end</span>;
        <span class="keyword">for</span> curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
            anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
            ttest2(DMSOanova{curB}.pchange, H20anova{curB}.pchange,<span class="string">'vartype'</span>,<span class="string">'unequal'</span> ) <span class="comment">%significant</span>
        <span class="keyword">end</span>;
        CONanova=H20anova;
        nlines=length(filepath.dmso);


    <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'tri'</span>)
        anovaData = TRIanova ; test = TRI;
        <span class="keyword">for</span> i=1:length(filepath.tri)
            <span class="keyword">if</span> mac
                    temp=strsplit( filepath.tri{i}  , <span class="string">'\'</span>);
                    n1=temp{end};
                <span class="keyword">else</span>
                    [p,n1,x] = fileparts( filepath.tri{i} );
                <span class="keyword">end</span>;

            n{i}=n1 ;
        <span class="keyword">end</span>;
        <span class="keyword">for</span> curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
            anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
            ttest2(TRIanova{curB}.pchange, H20anova{curB}.pchange,<span class="string">'vartype'</span>,<span class="string">'unequal'</span> ) <span class="comment">%significant</span>
        <span class="keyword">end</span>;
        CONanova=H20anova;
        nlines=length(filepath.tri );

    <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'gly'</span>)
        anovaData = GLYanova ; test = GLY ;
        <span class="keyword">for</span> i=1:length(filepath.gly)
             <span class="keyword">if</span> mac
                    temp=strsplit(filepath.gly{i} , <span class="string">'\'</span>);
                    n1=temp{end};
                <span class="keyword">else</span>
                    [p,n1,x] = fileparts( filepath.gly{i} );
                <span class="keyword">end</span>;

            n{i}=n1 ;
        <span class="keyword">end</span>;
        <span class="keyword">for</span> curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
            anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
            ttest2(GLYanova{curB}.pchange, H20anova{curB}.pchange,<span class="string">'vartype'</span>,<span class="string">'unequal'</span> ) <span class="comment">%significant</span>
        <span class="keyword">end</span>;
        CONanova=H20anova;
        nlines=length(filepath.gly );

   <span class="keyword">elseif</span> strcmp( chemName{1,k},<span class="string">'lin'</span>)
        anovaData = LINanova ; test = LIN ;
        <span class="keyword">for</span> i=1:length(filepath.lin)
            [p,n1,x] = fileparts( filepath.lin{i} );
            n{i}=n1 ;
        <span class="keyword">end</span>;
        <span class="keyword">for</span> curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, <span class="keyword">...</span>
            anova{curB}.ci, anova{curB}.stats ]=<span class="keyword">...</span>
            ttest2(LINanova{curB}.pchange, DMSOanova{curB}.pchange,<span class="string">'vartype'</span>,<span class="string">'unequal'</span> ) <span class="comment">%significant</span>
        <span class="keyword">end</span>;
        CONanova=DMSOanova;
        nlines=length(filepath.lin );

    <span class="keyword">end</span>;


    ex{1,1}=<span class="string">' '</span>; ex{2,1}=<span class="string">'1-4Hz'</span>; ex{3,1}=<span class="string">'4-8Hz'</span>; ex{4,1}=<span class="string">'8-14Hz'</span>;
    ex{5,1}=<span class="string">'14-30Hz'</span>; ex{6,1}=<span class="string">'30-50Hz'</span>;
    nFiles = length(anovaData{1}.pchange ) ;
    <span class="keyword">for</span> curfile=1:nFiles
        ex{1,1+curfile}=n{curfile} ;
    <span class="keyword">end</span>;

    <span class="keyword">for</span> j=1:5
        <span class="keyword">for</span> i=1:length(anovaData{1}.pchange)
            ex{1+j,i+1} = anovaData{j}.pchange(i);
        <span class="keyword">end</span>;
    <span class="keyword">end</span>;
    ex{1,2+nFiles}=<span class="string">'mean trt'</span>;
    ex{1,3+nFiles}=<span class="string">'sd trt'</span>;
    ex{1,4+nFiles}=<span class="string">'mean cont'</span>;
    ex{1,5+nFiles}=<span class="string">'sd con'</span>;
    ex{1,6+nFiles}=<span class="string">'t-test diff from contol'</span>;
    ex{1,7+nFiles}=<span class="string">'p-value'</span>;
    ex{1,8+nFiles}=<span class="string">'lci diff'</span>;
    ex{1,9+nFiles}=<span class="string">'uci diff'</span>;
    ex{1,10+nFiles}=<span class="string">'n trt'</span>;

    <span class="keyword">for</span> j=1:5
        ex{1+j,2+nFiles}= mean(anovaData{j}.pchange);
        ex{1+j,3+nFiles}= anova{j}.stats.sd(1) ;
        ex{1+j,4+nFiles}= mean(CONanova{j}.pchange);
        ex{1+j,5+nFiles}= anova{j}.stats.sd(2) ;
        ex{1+j,6+nFiles}= anova{j}.stats.tstat;
        ex{1+j,7+nFiles}= anova{j}.tp_value;
        ex{1+j,8+nFiles}= anova{j}.ci(1);
        ex{1+j,9+nFiles}= anova{j}.ci(2);
        ex{1+j,10+nFiles}= test{j}.stats.df+1;
    <span class="keyword">end</span>;
    [nrows,ncols] = size(ex);
        <span class="comment">% fileID = fopen(xlsfilestr,'w');</span>
        fprintf(fileID, strcat( chemName{1,k}, <span class="string">'\n'</span>)  );
        <span class="keyword">for</span> row = 1:nrows
            <span class="keyword">if</span> row==1
                formatSpec = strcat( repmat(<span class="string">'%s ,'</span>, 1,(size(ex,2)-1)) , <span class="string">' %s\n'</span>);
                fprintf(fileID,formatSpec, ex{row,:});

            <span class="keyword">else</span>
                formatSpec = strcat(<span class="string">'%s ,'</span>,repmat(<span class="string">'%d ,'</span>,1,(size(ex,2)-2)), <span class="string">' %d\n'</span>  );
                fprintf(fileID,formatSpec,ex{row,:});
            <span class="keyword">end</span>;
        <span class="keyword">end</span>;


    clear(<span class="string">'ex'</span>);


    <span class="comment">%set startCell to empty lines</span>
    startCell=startCell+10 ;
<span class="keyword">end</span>;

<span class="comment">% close the file</span>
fclose(fileID);
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% RUN T-TEST on %Change in LFP at 5 Different Bands
% t-test_anova.m
% Diana Hall
% 01/27/2014
% code to do anova

% add directory
mac=1;
if ~mac
    addpath(genpath('F:\EXTRAP\matlab_Cina_Herr_Diana\Scripts' ) )
else
    addpath(genpath('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/Scripts' ) )
end;



%% ++++++++++++++++++++++ACE++++++++++++++++++++++++++++++++++++++++++++
% load data
if ~mac
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_ace.mat');
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_conace.mat');
else
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_ace.mat');
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_conace.mat');
end;

% make analysis data set
filepath.ace=ace.filepath;
filepath.conace=con.filepath;
chem=ace;  
cont=con; cont.file = con.file;
nFiles=length(cont.file) ; 
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

ACEanova = make_t_anova_data(chem, cont, nFiles, want) ;
% run analysis
ACE = do_t_anova(ACEanova, want ) ;
clear('ace');clear('con');



%% ++++++++++++++++++++++++++  BIC ++++++++++++++++++++++++++++++++++++++
% load data
if ~mac
  load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_27_2014_bic.mat');
  load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\10_30_2014_biccon.mat');
else
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_27_2014_bic.mat');
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/10_30_2014_biccon.mat');
end;


%  t-test or anova
chem=bic; 
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ; 
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

filepath.bic=bic.filepath;
filepath.conbic=con.filepath ;

BICanova = make_t_anova_data_AEOnly(chem, cont, nFiles, want) ;

BIC = do_t_anova(BICanova, want ) ;
clear('bic'); clear('con');



%% +++++++++++++++++++++++CAR 5 uM +++++++++++++++++++++++++++++++++++++++
% load data
if ~mac
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_car5.mat');
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_car5con.mat');
else
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_car5.mat');
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_car5con.mat');
end;

% make analysis data set
chem=car;  
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ; 
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;
% get filepaths for writing
filepath.car5 = car.filepath;
filepath.concar5=con.filepath ;

CAR5anova = make_t_anova_data(chem, cont, nFiles, want) ;
% run analysis
CAR5 = do_t_anova(CAR5anova, want ) ;
%results: fail to reject at all bands 
clear('con'); clear('car');


%% ++++++++++++++++++++++++++++++++++++++++++++++++++CAR 15 uM +++++++++++++++
% load data
if ~mac
    load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_car15.mat');
    load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_car15con.mat');
else
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_car15.mat');
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_car15con.mat');
end;

% make analysis data set
chem=car;  
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ; 
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;
% get filepaths for writing
filepath.car15 = car.filepath;
filepath.concar15=con.filepath ;
echo off;
CAR15anova = make_t_anova_data(chem, cont, nFiles, want) ;
% run analysis
echo off;
CAR15 = do_t_anova(CAR15anova, want ) ;
%results: fail to reject at all bands 
for i=1:5
disp( strcat( ' band', num2str(i) ) )
disp(  CAR15{i}.t )
end;
clear('con'); clear('car');


%% +++++++++++++++++++++++++++++++++++++++++++++++++CAR 30 +++++++++++++++
% load data
if ~mac
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_car30.mat');
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_car30con.mat');
else
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_car30.mat');
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_car30con.mat');
end;

% make analysis data set
chem=car;  
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ; 
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;
% get filepaths for writing
filepath.car30 = car.filepath;
filepath.concar30=con.filepath ;

CAR30anova = make_t_anova_data(chem, cont, nFiles, want) ;
% run analysis
CAR30 = do_t_anova(CAR30anova, want ) ;
%results: fail to reject at all bands 
clear('car'); clear('con');




%% +++++++++++++DOMOIC ACID+++++++++++++++++++++++++++++++++++++++++++++++++
% load data
if ~mac
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\10_30_2014_da.mat');
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\10_30_2014_conDA.mat');
else
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/10_30_2014_da.mat');
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/10_30_2014_conDA.mat');
end;

% make analysis data set
filepath.da=da.filepath;
filepath.conda=con.filepath;
chem=da;  
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ; 
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

DAanova = make_t_anova_data(chem, cont, nFiles, want) ;
% run analysis
DA = do_t_anova(DAanova, want ) ;
% DA{1}
clear('da');clear('con');


%% ++++++++++++++++++++++++++++++++++++++++++++++++++++++DMSO+++++++++++++++
% load data
if ~mac
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\12_30_2014_dmso.mat');
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\12_30_2014_condmso.mat');
else
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/12_30_2014_dmso.mat');
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/12_30_2014_condmso.mat');
end;

% make analysis data set
filepath.dmso=dmso.filepath;
filepath.condmso=con.filepath;
chem=dmso;  
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ; 
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

DMSOanova = make_t_anova_data(chem, cont, nFiles, want) ;
% run analysis
DMSO = do_t_anova(DMSOanova, want ) ;
clear('dmso');clear('con');



%% +++++++++++++GLY+++++++++++++++++++++++++++++++++++++++++++++++++++++++++
% load data
if ~mac
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_gly.mat');
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_congly.mat');
else
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_gly.mat');
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_congly.mat');
end;

% make analysis data set
filepath.gly=gly.filepath;
filepath.congly=con.filepath;
chem=gly;  
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ; 
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

GLYanova = make_t_anova_data(chem, cont, nFiles, want) ;
% run analysis
GLY = do_t_anova(GLYanova, want ) ;
clear('gly');clear('con');





%% +++++++++++++++++++++++++++H20+++++++++++++++++++++++++++++++++++++++++
% load data
if ~mac
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_h20.mat');
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_conh20.mat');
else
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_h20.mat');
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_conh20.mat');
end;

% make analysis data set
filepath.h20=h20.filepath;
filepath.conh20=con.filepath;
chem=h20;  
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ; 
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

H20anova = make_t_anova_data(chem, cont, nFiles, want) ;
% run analysis
H20 = do_t_anova(H20anova, want ) ;
clear('h20');clear('con');






%% +++++++++++++LINDANE+++++++++++++++++++++++++++++++++++++++++++++++++
% load data
if ~mac
    load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\02_15_2016_lindane.mat');
    load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\02_15_2016_conlin.mat');
else
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/02_15_2016_lindane.mat');
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/02_15_2016_conlin.mat');
end;

% make analysis data set
filepath.lin=lin.filepath;
filepath.conlin=con.filepath;
chem=lin;  
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ; 
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

LINanova = make_t_anova_data(chem, cont, nFiles, want) ;
% run analysis
LIN = do_t_anova(LINanova, want ) ; % LIN{1}
clear('lin');clear('con');




%% ++++++++++++++++++++++++++++++PER25++++++++++++++++++++++++++++++++++++++
% load data
if ~mac
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\02_11_2014_per25.mat');
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\10_30_2014_per25con.mat');
else
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/02_11_2014_per25.mat');
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/10_30_2014_per25con.mat');
end;

% make analysis data set
chem=per;  
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ; 
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

filepath.per25=per.filepath;
filepath.conper25=con.filepath ;

PER25anova = make_t_anova_data(chem, cont, nFiles, want) ;
% run analysis
PER25 = do_t_anova(PER25anova, want ) ;
%results: fail to reject at bands = 1,2,3,4; sig. diff at band 5
clear('per');clear('con');



%% +++++++++++++++++++++PERM 50uM+++++++++++++++++++++++++++++++++++++++
% load data
if ~mac
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_per50.mat');
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_02_2015_conPER50.mat');
else
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_per50.mat');
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/01_02_2015_conPER50.mat');
end;

% make analysis data set
filepath.per50=per.filepath;
filepath.per50con=con.filepath;
chem=per;   %which files in con are PER baseline
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ; 
want.sec=0; want.ch=0; want.well=0; want.diff=0;want.pchange=1;

PER50anova = make_t_anova_data(chem, cont, nFiles, want) ;
% run analysis
PER50 = do_t_anova(PER50anova, want ) ;
%results: fail to reject at bands = 1,2,3,4; sig. diff at band 5
clear('per');clear('con');






%% +++++++++++++++++++++++++++++++++TRI+++++++++++++++++++++++++++++++++++++
% load data
if ~mac
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\8_9_2014_tri.mat');
 load('F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\8_9_2014_contri.mat');
else
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/8_9_2014_tri.mat');
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/8_9_2014_contri.mat');
end;

% make analysis data set
filepath.tri=tri.filepath;
filepath.conh20=con.filepath;
chem=tri;  
cont=con; cont.file = con.file ;
nFiles=length(cont.file) ; 
want.sec=0; want.ch=0; want.well=0;want.diff=0;want.pchange=1;

TRIanova = make_t_anova_data(chem, cont, nFiles, want) ;
% run analysis
TRI = do_t_anova(TRIanova, want ) ;
clear('tri');clear('con');









%% Save results

 if ~mac
    filename='F:\EXTRAP\matlab_Cina_Herr_Diana\finshed_data\01_03_2015_pChangeanova.mat' ;
 else 
     filename='/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/03_01_2016_pChangeanova.mat' ;
 end;
 save(filename, 'BIC','BICanova','ACE', 'ACEanova', ...
     'CAR5','CAR5anova','CAR15','CAR15anova','CAR30','CAR30anova',...
     'DA','DAanova','DMSO','DMSOanova','LIN', 'LINanova',...
     'GLY', 'GLYanova','H20','H20anova',...
     'PER25', 'PER25anova', 'PER50', 'PER50anova','TRI','TRIanova', ...
     'filepath') ;



 
 
 
 

%% T-test vs. baseline: Write Results
% ++++++++++++++++++++++++++++++++++++++
% write results with t-test H_0: t=1, H_a: t~=1
mac=1;
if ~mac
    addpath(genpath('F:\EXTRAP\matlab_Cina_Herr_Diana\Scripts' ) )
else
    addpath(genpath('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/Scripts' ) )
end;

wantData=1;
if wantData
    load('/Volumes/BACKUP/EXTRAP/matlab_Cina_Herr_Diana/finshed_data/03_01_2016_pChangeanova.mat');
end;



    xlsfilestr='/Volumes/BACKUP/EXTRAP/documents/Results/lfp_results_t-testdiff1_03_01_2016.csv';
    title1={'Results: % Baseline chem vs. % baseline control, mean all Electrodes, t-test: eq. var'};
    title=title{1};
    %da,gly,ace,tri are H20 controls
    %bic, car, per30, per50 are dmso controls
    chemName= {'ace','bic', 'da','dmso','car5','car15', 'car30','gly', 'h20',...
        'lin','per25','per50','tri' };

    fileID = fopen(xlsfilestr,'w');
    fprintf( fileID,'%s\n',  title );
    startCell=3;
    for k=1:size(chemName,2)
    % write files

        if strcmp( chemName{1,k},'per25' )
            anovaData = PER25anova ; test = PER25;
            for i=1:length(filepath.per25)
                if mac
                    temp=strsplit(filepath.per25{1}, '\');
                    n1=temp{end};
                else
                    [p,n1,x] = fileparts( filepath.per25{i} );
                end;
                n{i}=n1 ;
            end;
            % 2 sample t-test to control
            for curB=1:5
                [anova{curB}.t, anova{curB}.tp_value, ...
                anova{curB}.ci, anova{curB}.stats ]=...
                ttest2(PER25anova{curB}.pchange, DMSOanova{curB}.pchange ) %significant
            end;
            nlines=length(filepath.per25);

        elseif strcmp( chemName{1,k},'per50')
            anovaData = PER50anova ; test = PER50
            for i=1:length(filepath.per50)
                if mac
                    temp=strsplit( filepath.per50{i}, '\');
                    n1=temp{end};
                else
                    [p,n1,x] = fileparts( filepath.per50{i} );
                end;
                
                n{i}=n1 ;
            end;
            for curB=1:5
                [anova{curB}.t, anova{curB}.tp_value, ...
                anova{curB}.ci, anova{curB}.stats ]=...
                ttest2(PER50anova{curB}.pchange, DMSOanova{curB}.pchange ) %significant
            end;
            nlines=length(filepath.per50);


        elseif strcmp( chemName{1,k},'car5')
            anovaData = CAR5anova ; test = CAR5
            for i=1:length(filepath.car5)
                 if mac
                    temp=strsplit(  filepath.car5{i}, '\');
                    n1=temp{end};
                else
                     [p,n1,x] = fileparts( filepath.car5{i} );
                end;
               
                n{i}=n1 ;
            end;
            for curB=1:5
                [anova{curB}.t, anova{curB}.tp_value, ...
                anova{curB}.ci, anova{curB}.stats ]=...
                ttest2(anovaData{curB}.pchange, DMSOanova{curB}.pchange ) %significant
            end;
            nlines=length(filepath.car5);

        elseif strcmp( chemName{1,k},'car15')
            anovaData = CAR15anova ; test = CAR15 ;
            for i=1:length(filepath.car15 )
                if mac
                    temp=strsplit(  filepath.car15{i}, '\');
                    n1=temp{end};
                else
                     [p,n1,x] = fileparts( filepath.car15{i} );
                end;

                n{i}=n1 ;
            end;
            for curB=1:5
                [anova{curB}.t, anova{curB}.tp_value, ...
                anova{curB}.ci, anova{curB}.stats ]=...
                ttest2(anovaData{curB}.pchange, DMSOanova{curB}.pchange ) %significant
            end;
            nlines=length(filepath.car15);

        elseif strcmp( chemName{1,k},'car30')
            anovaData = CAR30anova ; test = CAR30 ;
            for i=1:length(filepath.car30)
                if mac
                    temp=strsplit( filepath.car30{i} , '\');
                    n1=temp{end};
                else
                     [p,n1,x] = fileparts( filepath.car30{i} );
                end;
               
                n{i}=n1 ;
            end;
            for curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, ...
                anova{curB}.ci, anova{curB}.stats ]=...
                ttest2(anovaData{curB}.pchange, DMSOanova{curB}.pchange ) %significant
            end;
            nlines=length(filepath.car30);

        elseif strcmp( chemName{1,k},'bic' )
            anovaData = BICanova ; test = BIC;
            for i=1:length(filepath.bic)
                 if mac
                    temp=strsplit( filepath.bic{i}  , '\');
                    n1=temp{end};
                else
                     [p,n1,x] = fileparts( filepath.bic{i} );
                end;
               
                n{i}=n1 ;
            end;
            for curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, ...
                anova{curB}.ci, anova{curB}.stats ]=...
                ttest2(BICanova{curB}.pchange, DMSOanova{curB}.pchange ) %significant
            end;
            nlines=length(filepath.bic);

        elseif strcmp( chemName{1,k},'da')
            anovaData = DAanova ; test = DA
            for i=1:length(filepath.da)
                 if mac
                    temp=strsplit(filepath.da{i} , '\');
                    n1=temp{end};
                else
                     [p,n1,x] = fileparts( filepath.da{i} );
                end;
               
                n{i}=n1 ;
            end;
            for curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, ...
                anova{curB}.ci, anova{curB}.stats ]=...
                ttest2(DAanova{curB}.pchange, H20anova{curB}.pchange ) %significant
            end;
            nlines=length(filepath.da);


        elseif strcmp( chemName{1,k},'ace')
            anovaData = ACEanova ; test = ACE
            for i=1:length(filepath.ace )
                if mac
                    temp=strsplit( filepath.ace{i} , '\');
                    n1=temp{end};
                else
                    [p,n1,x] = fileparts( filepath.ace{i} );
                end;
                
                n{i}=n1 ;
            end;
            for curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, ...
                anova{curB}.ci, anova{curB}.stats ]=...
                ttest2(ACEanova{curB}.pchange, H20anova{curB}.pchange ) %significant
            end;
            nlines=length(filepath.ace);

        elseif strcmp( chemName{1,k},'h20')
            anovaData = H20anova ; test = H20
            for i=1:length(filepath.h20)
                if mac
                    temp=strsplit(filepath.h20{i} , '\');
                    n1=temp{end};
                else
                   [p,n1,x] = fileparts( filepath.h20{i} );
                end;
                
                n{i}=n1 ;
            end;
            nlines=length(filepath.h20);

        elseif strcmp( chemName{1,k},'dmso')
            anovaData = DMSOanova ; test = DMSO
            for i=1:length(filepath.dmso)

                if mac
                    temp=strsplit(filepath.dmso{i}, '\');
                    n1=temp{end};
                else
                   [p,n1,x] = fileparts( filepath.dmso{i} );
                end;
 
                n{i}=n1 ;
            end;
            nlines=length(filepath.dmso);


        elseif strcmp( chemName{1,k},'tri')
            anovaData = TRIanova ; test = TRI;
            for i=1:length(filepath.tri)
                 if mac
                    temp=strsplit( filepath.tri{i} , '\');
                    n1=temp{end};
                else
                  [p,n1,x] = fileparts( filepath.tri{i} );
                end;
                
                n{i}=n1 ;
            end;
            for curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, ...
                anova{curB}.ci, anova{curB}.stats ]=...
                ttest2(TRIanova{curB}.pchange, H20anova{curB}.pchange ) %significant
            end;
            nlines=length(filepath.tri );

        elseif strcmp( chemName{1,k},'gly')
            anovaData = GLYanova ; test = GLY ;
            for i=1:length(filepath.gly)
                if mac
                    temp=strsplit(  filepath.gly{i} , '\');
                   n1=temp{end};
                else
                  [p,n1,x] = fileparts( filepath.gly{i} );
                end;
                
                n{i}=n1 ;
            end;
            for curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, ...
                anova{curB}.ci, anova{curB}.stats ]=...
                ttest2(GLYanova{curB}.pchange, H20anova{curB}.pchange ) %significant
            end;
            nlines=length(filepath.gly );
        elseif strcmp( chemName{1,k},'lin')
            anovaData = LINanova ; test = LIN ;
            for i=1:length(filepath.lin)

                  [p,n1,x] = fileparts( filepath.lin{i} );

                
                n{i}=n1 ;
            end;
            for curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, ...
                anova{curB}.ci, anova{curB}.stats ]=...
                ttest2(LINanova{curB}.pchange, DMSOanova{curB}.pchange ) %significant
            end;
            nlines=length(filepath.lin );

        end;

        ex{1,1}=' '; ex{2,1}='1-4Hz'; ex{3,1}='4-8Hz'; ex{4,1}='8-14Hz'; 
        ex{5,1}='14-30Hz'; ex{6,1}='30-50Hz';
        nFiles = length(anovaData{1}.pchange ) ;
        for curfile=1:nFiles
            ex{1,1+curfile}=n{curfile} ;

        end;

        for j=1:5
            for i=1:length(anovaData{1}.pchange)
                ex{1+j,i+1} = anovaData{j}.pchange(i);
            end;
        end;
        ex{1,2+nFiles}='mean';
        ex{1,3+nFiles}='se';
        ex{1,4+nFiles}='sd'; 
        ex{1,5+nFiles}='t-test diff from 1'; 
        ex{1,6+nFiles}='p-value'; 
        ex{1,7+nFiles}='lci'; 
        ex{1,8+nFiles}='uci';
        ex{1,9+nFiles}='n';
        for j=1:5
            ex{1+j,2+nFiles}= mean(anovaData{j}.pchange);
            ex{1+j,3+nFiles}= test{j}.stats.sd/length(anovaData{j}.pchange);
            ex{1+j,4+nFiles}= test{j}.stats.sd; 
            ex{1+j,5+nFiles}= test{j}.stats.tstat; 
            ex{1+j,6+nFiles}= test{j}.tp_value; 
            ex{1+j,7+nFiles}= test{j}.ci(1); 
            ex{1+j,8+nFiles}= test{j}.ci(2); 
            ex{1+j,9+nFiles}= test{j}.stats.df+1;
        end;
        
        [nrows,ncols] = size(ex);
        % fileID = fopen(xlsfilestr,'w');
        fprintf(fileID, strcat( chemName{1,k}, '\n')  );
        for row = 1:nrows
            if row==1
                formatSpec = strcat( repmat('%s ,', 1,(size(ex,2)-1)) , ' %s\n');
                fprintf(fileID,formatSpec, ex{row,:});
                
            else
                formatSpec = strcat('%s ,',repmat('%d ,',1,(size(ex,2)-2)), ' %d\n'  ); 
                fprintf(fileID,formatSpec,ex{row,:});
            end;
        end;
    
        clear('ex');

        %set startCell to empty lines
        startCell=startCell+10 ;
    end; % end of for loop

    % close the file
    fclose(fileID);






    
    
%% +++++++ OUTPUT T-Test vs Control ++++++++++++++++++++++++++++++++++++++
% write results with t-test H_0: t=1, H_a: t~=1
if ~mac
    xlsfilestr='F:\EXTRAP\documents\Results\lfp_results_t-testwControl_01_06_2015.csv';
else
    xlsfilestr='/Volumes/BACKUP/EXTRAP/documents/Results/lfp_results_t-testvControl_03_01_2016.csv';
end;
title1={'Results: % Baseline chem vs. % baseline control, mean all Electrodes, t-test uneq. var'};
title=title1{1};
fileID = fopen(xlsfilestr,'w');
fprintf( fileID,'%s\n',  title );

%da,gly,ace,tri are H20 controls
%bic, car, per30, per50 are dmso controls
chemName= {'ace','bic', 'da','dmso','car5','car15', 'car30','gly', 'h20',...
    'lin','per25','per50','tri' };

     
startCell=3;
for k=1:size(chemName,2)
% write files

    if strcmp( chemName{1,k},'per25' )
        anovaData = PER25anova ; test = PER25;
        for i=1:length(filepath.per25)
            if mac
                 temp=strsplit( filepath.per25{i} , '\');
                   n1=temp{end};
                else
                   [p,n1,x] = fileparts( filepath.per25{i} );
                end;

            n{i}=n1 ;
        end;
        % 2 sample t-test to control
        for curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, ...
            anova{curB}.ci, anova{curB}.stats ]=...
            ttest2(PER25anova{curB}.pchange, DMSOanova{curB}.pchange,'vartype','unequal' ) %significant
        end;
        CONanova=DMSOanova;
        nlines=length(filepath.per25);
        
    elseif strcmp( chemName{1,k},'per50')
        anovaData = PER50anova ; test = PER50
        for i=1:length(filepath.per50)
             if mac
                 temp=strsplit( filepath.per50{i} , '\');
                   n1=temp{end};
                else
                   [p,n1,x] = fileparts( filepath.per50{i} );
                end;
            
            n{i}=n1 ;
        end;
        for curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, ...
            anova{curB}.ci, anova{curB}.stats ]=...
            ttest2(PER50anova{curB}.pchange, DMSOanova{curB}.pchange,'vartype','unequal' ) %significant
        end;
        CONanova=DMSOanova;
        nlines=length(filepath.per50);
        
        
    elseif strcmp( chemName{1,k},'car5')
        anovaData = CAR5anova ; test = CAR5
        for i=1:length(filepath.car5)
            if mac
                 temp=strsplit(  filepath.car5{i}  , '\');
                   n1=temp{end};
                else
                    [p,n1,x] = fileparts( filepath.car5{i} );
                end;
           
            n{i}=n1 ;
        end;
        for curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, ...
            anova{curB}.ci, anova{curB}.stats ]=...
            ttest2(anovaData{curB}.pchange, DMSOanova{curB}.pchange,'vartype','unequal' ) %significant
        end;
        CONanova=DMSOanova;
        nlines=length(filepath.car5);
      
    elseif strcmp( chemName{1,k},'car15')
        anovaData = CAR15anova ; test = CAR15 ;
        for i=1:length(filepath.car15 )
            if mac
                 temp=strsplit(  filepath.car15{i}  , '\');
                   n1=temp{end};
                else
                     [p,n1,x] = fileparts( filepath.car15{i} );
                end;
           
            n{i}=n1 ;
        end;
        for curB=1:5
            [anova{curB}.t, anova{curB}.tp_value, ...
            anova{curB}.ci, anova{curB}.stats ]=...
            ttest2(anovaData{curB}.pchange, DMSOanova{curB}.pchange,'vartype','unequal' ) %significant
        end;
        CONanova=DMSOanova;
        nlines=length(filepath.car15);
     
    elseif strcmp( chemName{1,k},'car30')
        anovaData = CAR30anova ; test = CAR30 ;
        for i=1:length(filepath.car30)
            if mac
                 temp=strsplit(  filepath.car30{i}  , '\');
                   n1=temp{end};
                else
                    [p,n1,x] = fileparts( filepath.car30{i} );
                end;
            
            n{i}=n1 ;
        end;
        for curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, ...
            anova{curB}.ci, anova{curB}.stats ]=...
            ttest2(anovaData{curB}.pchange, DMSOanova{curB}.pchange,'vartype','unequal' ) %significant
        end;
        CONanova=DMSOanova;
        nlines=length(filepath.car30);
        
    elseif strcmp( chemName{1,k},'bic' )
        anovaData = BICanova ; test = BIC;
        for i=1:length(filepath.bic)
            if mac
                 temp=strsplit(filepath.bic{i}  , '\');
                   n1=temp{end};
                else
                    [p,n1,x] = fileparts( filepath.bic{i} );
                end;
            
            n{i}=n1 ;
        end;
        for curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, ...
            anova{curB}.ci, anova{curB}.stats ]=...
            ttest2(BICanova{curB}.pchange, DMSOanova{curB}.pchange,'vartype','unequal' ) %significant
        end;
        CONanova=DMSOanova;
        nlines=length(filepath.bic);
        
    elseif strcmp( chemName{1,k},'da')
        anovaData = DAanova ; test = DA
        for i=1:length(filepath.da)
              if mac
                 temp=strsplit(filepath.da{i}  , '\');
                   n1=temp{end};
                else
                    [p,n1,x] = fileparts( filepath.da{i} );
                end;
            
            n{i}=n1 ;
        end;
        for curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, ...
            anova{curB}.ci, anova{curB}.stats ]=...
            ttest2(DAanova{curB}.pchange, H20anova{curB}.pchange,'vartype','unequal' ) %significant
        end;
        CONanova=H20anova;
        nlines=length(filepath.da);
        
    
    elseif strcmp( chemName{1,k},'ace')
        anovaData = ACEanova ; test = ACE
        for i=1:length(filepath.ace )
            if mac
                
                    temp=strsplit( filepath.ace{i}   , '\');
                    n1=temp{end};
                else
                   [p,n1,x] = fileparts( filepath.ace{i} );
                end;
            
            n{i}=n1 ;
        end;
        for curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, ...
            anova{curB}.ci, anova{curB}.stats ]=...
            ttest2(ACEanova{curB}.pchange, H20anova{curB}.pchange,'vartype','unequal' ) %significant
        end;
        CONanova=H20anova;
        nlines=length(filepath.ace);
            
    elseif strcmp( chemName{1,k},'h20')
        anovaData = H20anova ; test = H20
        for i=1:length(filepath.h20)
            if mac
                    temp=strsplit( filepath.h20{i}   , '\');
                    n1=temp{end};
                else
                   [p,n1,x] = fileparts( filepath.h20{i} );
                end;
            
            n{i}=n1 ;
        end;
        for curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, ...
            anova{curB}.ci, anova{curB}.stats ]=...
            ttest2(H20anova{curB}.pchange, DMSOanova{curB}.pchange,'vartype','unequal' ) %significant
        end;
        CONanova=DMSOanova;
        nlines=length(filepath.h20);
        
    elseif strcmp( chemName{1,k},'dmso')
        anovaData = DMSOanova ; test = DMSO
        for i=1:length(filepath.dmso)
            if mac
                    temp=strsplit( filepath.dmso{i}   , '\');
                    n1=temp{end};
                else
                   [p,n1,x] = fileparts( filepath.dmso{i} );
                end;
            
            n{i}=n1 ;
        end;
        for curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, ...
            anova{curB}.ci, anova{curB}.stats ]=...
            ttest2(DMSOanova{curB}.pchange, H20anova{curB}.pchange,'vartype','unequal' ) %significant
        end;
        CONanova=H20anova;
        nlines=length(filepath.dmso);
        
        
    elseif strcmp( chemName{1,k},'tri')
        anovaData = TRIanova ; test = TRI;
        for i=1:length(filepath.tri)
            if mac
                    temp=strsplit( filepath.tri{i}  , '\');
                    n1=temp{end};
                else
                    [p,n1,x] = fileparts( filepath.tri{i} );
                end;
            
            n{i}=n1 ;
        end;
        for curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, ...
            anova{curB}.ci, anova{curB}.stats ]=...
            ttest2(TRIanova{curB}.pchange, H20anova{curB}.pchange,'vartype','unequal' ) %significant
        end;
        CONanova=H20anova;
        nlines=length(filepath.tri );
    
    elseif strcmp( chemName{1,k},'gly')
        anovaData = GLYanova ; test = GLY ;
        for i=1:length(filepath.gly)
             if mac
                    temp=strsplit(filepath.gly{i} , '\');
                    n1=temp{end};
                else
                    [p,n1,x] = fileparts( filepath.gly{i} );
                end;
            
            n{i}=n1 ;
        end;
        for curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, ...
            anova{curB}.ci, anova{curB}.stats ]=...
            ttest2(GLYanova{curB}.pchange, H20anova{curB}.pchange,'vartype','unequal' ) %significant
        end;
        CONanova=H20anova;
        nlines=length(filepath.gly );
        
   elseif strcmp( chemName{1,k},'lin')
        anovaData = LINanova ; test = LIN ;
        for i=1:length(filepath.lin)
            [p,n1,x] = fileparts( filepath.lin{i} );
            n{i}=n1 ;
        end;
        for curB=1:5
        [anova{curB}.t, anova{curB}.tp_value, ...
            anova{curB}.ci, anova{curB}.stats ]=...
            ttest2(LINanova{curB}.pchange, DMSOanova{curB}.pchange,'vartype','unequal' ) %significant
        end;
        CONanova=DMSOanova;
        nlines=length(filepath.lin );
     
    end;
    
    
    ex{1,1}=' '; ex{2,1}='1-4Hz'; ex{3,1}='4-8Hz'; ex{4,1}='8-14Hz'; 
    ex{5,1}='14-30Hz'; ex{6,1}='30-50Hz';
    nFiles = length(anovaData{1}.pchange ) ;
    for curfile=1:nFiles
        ex{1,1+curfile}=n{curfile} ;
    end;
    
    for j=1:5
        for i=1:length(anovaData{1}.pchange)
            ex{1+j,i+1} = anovaData{j}.pchange(i);
        end;
    end;
    ex{1,2+nFiles}='mean trt';
    ex{1,3+nFiles}='sd trt';
    ex{1,4+nFiles}='mean cont';
    ex{1,5+nFiles}='sd con'; 
    ex{1,6+nFiles}='t-test diff from contol'; 
    ex{1,7+nFiles}='p-value'; 
    ex{1,8+nFiles}='lci diff'; 
    ex{1,9+nFiles}='uci diff';
    ex{1,10+nFiles}='n trt';
    
    for j=1:5
        ex{1+j,2+nFiles}= mean(anovaData{j}.pchange);
        ex{1+j,3+nFiles}= anova{j}.stats.sd(1) ; 
        ex{1+j,4+nFiles}= mean(CONanova{j}.pchange);
        ex{1+j,5+nFiles}= anova{j}.stats.sd(2) ;
        ex{1+j,6+nFiles}= anova{j}.stats.tstat; 
        ex{1+j,7+nFiles}= anova{j}.tp_value; 
        ex{1+j,8+nFiles}= anova{j}.ci(1); 
        ex{1+j,9+nFiles}= anova{j}.ci(2); 
        ex{1+j,10+nFiles}= test{j}.stats.df+1;
    end;
    [nrows,ncols] = size(ex);
        % fileID = fopen(xlsfilestr,'w');
        fprintf(fileID, strcat( chemName{1,k}, '\n')  );
        for row = 1:nrows
            if row==1
                formatSpec = strcat( repmat('%s ,', 1,(size(ex,2)-1)) , ' %s\n');
                fprintf(fileID,formatSpec, ex{row,:});
                
            else
                formatSpec = strcat('%s ,',repmat('%d ,',1,(size(ex,2)-2)), ' %d\n'  ); 
                fprintf(fileID,formatSpec,ex{row,:});
            end;
        end;
    
        
    clear('ex');
    
    
    %set startCell to empty lines
    startCell=startCell+10 ;
end; 

% close the file
fclose(fileID);















##### SOURCE END #####
--></body></html>